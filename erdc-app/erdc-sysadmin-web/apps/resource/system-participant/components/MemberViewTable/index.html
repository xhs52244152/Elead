<div class="fam-member-table">
    <fam-view-table
        ref="famViewTable"
        :view-table-config="viewTableConfig"
    >
        <template #column:default:operation:content="{ scope }">
            <erd-button
                v-for="item in columnOperBtnList"
                v-if="fnIsShowBtn(scope.row, item)"
                type="text"
                :key="item.key"
                :class="item.class"
                :icon="item.icon"
                :disabled="item.disable || false"
                @click="item.onclick(scope.row)"
            >
                {{item.label}}
            </erd-button>
        </template>
    </fam-view-table>

    <!--新增、编辑、查看用户-->
    <erd-ex-dialog
        ref="dialog"
        :visible.sync="form.visible"
        :title="form.editable ? i18nMappingObj.editMember : form.readonly ? i18nMappingObj.readonlyMember : i18nMappingObj.addMember"
        @close="fnCloseMemberForm"
    >
        <MemberForm
            v-if="form.visible"
            ref="memberForm"
            :oid="form.oid"
            :default-value="form.defaultValue"
            :editable="form.editable"
            :readonly="form.readonly"
            @callback="callback"
            class="memberForm"
        ></MemberForm>
        <template #footer>
            <div v-if="form.readonly">
                <erd-button
                    v-for="item in viewOperBtnList"
                    v-if="fnIsShowBtn(currentOperMemberRow, item)"
                    :type="item.type"
                    :key="item.key"
                    :class="item.class"
                    :icon="item.icon"
                    :disabled="item.disable || false"
                    @click="item.onclick(currentOperMemberRow, item.clickParams || {})"
                >
                    {{item.label}}
                </erd-button>
            </div>
            <div v-else>
                <erd-button
                    type="primary"
                    v-loading="form.loading"
                    @click="fnOnSubmit('memberForm')"
                    >{{ i18nMappingObj.ok }}</erd-button
                >
                <erd-button
                    v-loading="form.loading"
                    @click="fnCloseMemberForm"
                    >{{ i18nMappingObj.cancel }}</erd-button
                >
            </div>
        </template>
    </erd-ex-dialog>

    <!-- 加入部门 -->
    <erd-ex-dialog
        custom-class="joinOrgDialog"
        ref="joinOrgDialog"
        :visible.sync="joinOrgForm.joinOrgVisible"
        :title="i18nMappingObj.joinOrgTitle"
    >
        <join-member-select
            v-if="joinOrgForm.joinOrgVisible"
            ref="joinMemberSelect"
            org-id="orgId"
        ></join-member-select>
        <template #footer>
            <erd-button
                type="primary"
                v-loading="joinOrgForm.loading"
                @click="fnSubmitJoinMember"
                >{{ i18nMappingObj.ok }}</erd-button
            >
            <erd-button
                v-loading="joinOrgForm.loading"
                @click="joinOrgForm.joinOrgVisible = false"
                >{{ i18nMappingObj.cancel }}</erd-button
            >
        </template>
    </erd-ex-dialog>

    <!-- 离职 -->
    <erd-ex-dialog
        ref="dimissionHandoverDialog"
        :visible.sync="dimission.visible"
        :title="i18nMappingObj.dimissionTips"
    >
        <dimission-handover
            v-if="dimission.visible"
            ref="dimissionHandover"
            org-id="orgId"
            :multiple="dimission.multiple"
            :dimission-member-list="dimission.dimissionMember"
        ></dimission-handover>
        <template #footer>
            <erd-button
                type="primary"
                v-loading="dimission.loading"
                @click="fnOnSubmitDimission"
                >{{ i18nMappingObj.ok }}</erd-button
            >
            <erd-button
                v-loading="dimission.loading"
                @click="fnCloseDimissionDialog"
                >{{ i18nMappingObj.cancel }}</erd-button
            >
        </template>
    </erd-ex-dialog>

    <!-- 重置密码 -->
    <erd-ex-dialog
        ref="resetPasswordDialog"
        :visible.sync="resetPassword.visible"
        :title="i18nMappingObj.resetPassword"
    >
        <FamDynamicForm
            v-if="resetPassword.visible"
            ref="resetPassDynamicForm"
            :data="formItemData"
        >
        </FamDynamicForm>
        <template #footer>
            <erd-button
                type="primary"
                v-loading="resetPassword.loading"
                @click="resetPasswordSubmit"
                >{{ i18nMappingObj.ok }}</erd-button
            >
            <erd-button
                v-loading="resetPassword.loading"
                @click="()=>{resetPassword.visible=false;resetPassword.loading=false;}"
                >{{ i18nMappingObj.cancel }}</erd-button
            >
        </template>
    </erd-ex-dialog>
</div>
