!function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,n){"use strict";var o,r,i;t.__esModule=!0,o=t.Log||(t.Log={}),r=!1,i="[JIGUANG-JAnalytics]",o.setDebugMode=function(e){o.d(i,"setDebugMode:"+e),r=e},o.d=function(e,t){},o.dd=function(e,t){r&&window.console&&console.log(i+"["+e+"]"+t)},o.ww=function(e,t){window.console&&console.warn(i+"["+e+"]"+t)},o.ee=function(e,t){window.console&&console.error(i+"["+e+"]"+t)}},function(e,t,n){"use strict";function o(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function r(e){return!e||0==e.length}t.__esModule=!0,t.uuid=function(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()},t.isEmpty=r,t.supportPostMessage=function(){return!!window.postMessage},t.jgEncrypto=function(e){if(r(e))return"";for(var t=String.fromCharCode(e.charCodeAt(0)+e.length),n=1;n<e.length;n++)t+=String.fromCharCode(111^e.charCodeAt(n));return escape(t)},t.jgDecrypto=function(e){if(r(e))return"";e=unescape(e);for(var t=String.fromCharCode(e.charCodeAt(0)-e.length),n=1;n<e.length;n++)t+=String.fromCharCode(111^e.charCodeAt(n));return t}},function(e,t,n){"use strict";t.__esModule=!0,t.APPKEY="APPKEY",t.DEVICEID="DEVICEID",t.ACTION_INIT="init",t.ACTION_ONEVENT="onEvent",t.ACTION_ONPAGE="onPage",t.ACTION_ONLOC="onLoc",t.ACTION_ONLOC_CHECK="onCheckLoc";var o=function(){this.lReg=0,this.lRep=0};t.LocalVariable=o,t.packageInterfaceMessageBody=function(e,t,n){return{action:e,data:t,callbackId:n}},t.packageIframeRespond=function(e,t,n,o,r){return{from:e,type:"onRespond",body:{action:t,callbackId:n,code:o,result:r}}}},function(e,t,n){"use strict";t.__esModule=!0;var o=n(2),r=n(1),i=n(0),a=n(4),s="UserInfoHelper",c={uid:0,rId:"",pw:""},u="";function l(e){a.setLocal(o.DEVICEID,e)||a.setCookie(o.DEVICEID,e,3650)}function d(e){if(!r.isEmpty(e)){var t=e.split("|");c={uid:parseInt(t[0]),rId:t[1],pw:t[2]}}return c}t.getDeviceId=function(e){return r.isEmpty(u)?(u=a.getLocal(o.DEVICEID),r.isEmpty(u)?(u=a.getCookie(o.DEVICEID),r.isEmpty(u)?(l(u=r.isEmpty(e)?r.uuid()+Date.now():e),i.Log.d(s,"New devicdId:"+u)):i.Log.d(s,"getDeviceId from cookie:"+u)):i.Log.d(s,"getDeviceId from local:"+u)):i.Log.d(s,"getDeviceId from running:"+u),u},t.getDeviceIdWhitEmpty=function(){var e=a.getLocal(o.DEVICEID);return r.isEmpty(e)?(e=a.getCookie(o.DEVICEID),r.isEmpty(e)?"":e):e},t.setDeviceId=l,t.getUserInfo=function(e){return 0<c.uid?i.Log.d(s,"getUserInfo from running:"+c.uid):0<(c=d(a.getLocal(e+"_U"))).uid?i.Log.d(s,"getUserInfo from local:"+c.uid):0<(c=d(a.getCookie(e+"_U"))).uid?i.Log.d(s,"getUserInfo from Cookie:"+c.uid):i.Log.d(s,"No uid."),c},t.setUserInfo=function(e,t){if(t){var n=(c=t).uid+"|"+t.rId+"|"+t.pw;a.setLocal(e+"_U",n)||a.setCookie(e+"_U",n,3650)}}},function(e,t,n){"use strict";t.__esModule=!0;var a=n(0),i=n(1),s="WebStore";function c(e){try{var t=window.localStorage;if(t){var n=i.jgEncrypto(e),o=t.getItem("JG_"+n);return o?JSON.parse(i.jgDecrypto(o)):null}}catch(e){}return a.Log.d(s,"The browser does not support localStorage.GET"),null}function o(e,t,n){if(void 0===n&&(n=0),!navigator.cookieEnabled)return a.Log.d(s,"The browser does not support cookies.SET"),!1;var o="JG_"+e+"="+t;if(0==n)document.cookie=o;else{var r=new Date;r.setDate(r.getDate()+n);var i="expires="+r.toUTCString();document.cookie=o+"; "+i}return a.Log.d(s,"Cookie.SET："+o),!0}t.setLocal=function(e,t){try{var n=window.localStorage;if(n&&t){var o=i.jgEncrypto(e),r=i.jgEncrypto(JSON.stringify(t));if(n.setItem("JG_"+o,r),c(e))return a.Log.d(s,"LocalStorage.SET："+e+"="+JSON.stringify(t)),!0}}catch(e){}return a.Log.d(s,"The browser does not support localStorage.SET"),!1},t.getLocal=c,t.removeLocal=function(e){try{var t=window.localStorage;if(t){var n=i.jgEncrypto(e);return t.removeItem("JG_"+n),!0}}catch(e){return!1}},t.setCookie=o,t.getCookie=function(e){if(!navigator.cookieEnabled)return a.Log.d(s,"The browser does not support cookies.GET"),"";for(var t=document.cookie.replace(/\s/g,"").split(";"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]=="JG_"+e)return decodeURIComponent(o[1])}return null},t.removeCookie=function(e){return o(name,"0",-1)}},function(e,t,n){"use strict";t.__esModule=!0;var o=n(2),r=n(4),i=n(1);function a(e){if(i.isEmpty(e))return null;var t=e.split("|");return{lReg:parseInt(t[0]),lRep:parseInt(t[1])}}t.getLocalVariable=function(e){var t=a(r.getLocal(e+"_LV"));return t||(t=a(r.getCookie(e+"_LV")))||new o.LocalVariable},t.clearLocalVariable=function(e){r.removeLocal(e+"_LV")||r.removeCookie(e+"_LV")},t.setLocalVariable=function(e,t,n){var o=t+"|"+n;r.setLocal(e+"_LV",o)||r.setCookie(e+"_LV",o)},t.getPageVariable=function(e,t){if(!navigator.cookieEnabled)return{vId:"",lPage:t,duration:0};var n=function(e){if(i.isEmpty(e))return{vId:"",lPage:0};var t=e.split("|");return{vId:t[0],lPage:parseInt(t[1])}}(r.getCookie(e+"_PV"));return i.isEmpty(n.vId)||18e5<t-n.lPage||t-n.lPage<0?(n.vId=t+"",n.duration=0):n.duration=Math.round((t-n.lPage)/1e3),n.lPage=t,r.setCookie(e+"_PV",n.vId+"|"+n.lPage),n}},,,function(e,t,n){"use strict";t.__esModule=!0;var r=n(2),a=n(0),s=n(1),o=n(3),i=n(9),c=n(5),u=n(10),l="JAnalyticsInterface",d=new(function(){function e(){this.mIsInited=!1,this.mIsRegister=void 0,this.callbackCache={}}return e.prototype.handleEvent=function(e){if("message"===e.type){try{var t=JSON.parse(e.data)}catch(e){return}if("JAnalytics"!=t.from)return;a.Log.d(l,"receive event with event.data:"+e.data),"onRespond"==t.type&&this.handleRespond(t.body)}},e.prototype.handleRespond=function(e){var t=e.callbackId;t&&this.callbackCache[t]&&((0,this.callbackCache[t])(e),1===e.code&&delete this.callbackCache[t])},e.prototype.init=function(e){var t=this;if(this.mIsInited)a.Log.dd(l,"need not init multi times");else if(a.Log.setDebugMode(e.debugMode),s.supportPostMessage()){if(s.isEmpty(e.appkey))a.Log.ee(l,"init failed,appKey is empty");else if(s.isEmpty(e.channel)&&(e.channel="default-channel"),this.mIsInited=!0,e.sdkVersion="1.0.0",a.Log.dd(l,"action:init - sdkVersion:"+e.sdkVersion),this.mJanalyticsFrame=document.createElement("iframe"),this.mJanalyticsFrame.onload=function(){a.Log.d(l,"iframe onload"),e.hostname=location.hostname,e.protocal=location.protocol,e.resolution=screen.width+"*"+screen.height,t.mInitConfig=e,t.register(e)},this.mJanalyticsFrame.src="https://web-stat.jpush.cn/web/report/html/janalytics.html",this.mJanalyticsFrame.style.display="none",this.mJanalyticsFrame.id="jiguang_iframe",window.addEventListener("message",this,!1),document.body.appendChild(this.mJanalyticsFrame),window.onpageshow=function(e){e.persisted&&d&&d.reportPageInfo()},e.singlePage&&window.history){a.Log.d(l,"single page = true");var n=window.history;if(n.pushState){var o=n.pushState,r=this;n.pushState=function(e){var t=o.apply(n,arguments);return r.reportPageInfo(),t}}if(n&&n.replaceState){var i=n.replaceState;r=this,n.replaceState=function(e){var t=i.apply(n,arguments);return r.reportPageInfo(),t}}}}else a.Log.ee(l,"This browser does not support postMessage,JAnalytics is not available.")},e.prototype.register=function(t){var n=this,e=o.getUserInfo(t.appkey);if(e.dId=o.getDeviceIdWhitEmpty(),0==e.uid&&Date.now()-c.getLocalVariable(t.appkey+1).lReg<3e4)return a.Log.dd(l,"Other tabs are registering,try in 30 seconds..."),void setTimeout(function(){n.register(t)},3e4);this.callJAnalytics(r.packageInterfaceMessageBody(r.ACTION_INIT,{initConfig:t,userInfo:e}),function(e){e.action==r.ACTION_INIT&&(a.Log.d(l,"init callback:"+JSON.stringify(e)),n.mIsRegister||1!=e.code?2==e.code?(n.mIsRegister=!1,n.mRegisterCode=e.result,c.clearLocalVariable(t.appkey+1)):3==e.code&&(c.setLocalVariable(t.appkey+1,e.result.itime,0),o.setDeviceId(e.result.deviceId)):(n.mIsRegister=!0,n.saveUserInfo(e.result),n.reportPageInfo(),n.reportLocInfo(),n.reportEvents(u.EventCacheHelper.getEvents(),!0)))})},e.prototype.saveUserInfo=function(e){o.setUserInfo(this.mInitConfig.appkey,e)},e.prototype.reportPageInfo=function(){if(this.mIsRegister){a.Log.dd(l,"Report page info.");var e=Date.now(),t={title:document.title,url:document.URL,referer:document.referrer,itime:e,pv:c.getPageVariable(this.mInitConfig.appkey+1,e),resolution:screen.width+"*"+screen.height};this.callJAnalytics(r.packageInterfaceMessageBody(r.ACTION_ONPAGE,t))}},e.prototype.reportLocInfo=function(){var t=this;if(this.mIsRegister&&(null==this.mInitConfig.loc||this.mInitConfig.loc)){if(!navigator.geolocation||"https:"!=location.protocol)return void a.Log.ww(l,"Not support geolocation.");var n=Date.now();this.callJAnalytics(r.packageInterfaceMessageBody(r.ACTION_ONLOC_CHECK,n),function(e){e.action==r.ACTION_ONLOC_CHECK&&1==e.code&&t.onCheckLoc(n)})}},e.prototype.onCheckLoc=function(e){var t=this;this.mIsRegister&&(9e5<=e-c.getLocalVariable(this.mInitConfig.appkey+1).lRep?this.onLocInfo():(a.Log.dd(l,"Loc info has been tried to reported in 15 minutes"),setTimeout(function(){t.onCheckLoc(Date.now())},9e5)))},e.prototype.onLocInfo=function(){var n=this,o=Date.now();c.setLocalVariable(this.mInitConfig.appkey+1,0,o),navigator.geolocation.getCurrentPosition(function(e){a.Log.dd(l,"Report loc info.");var t={lat:e.coords.latitude,lng:e.coords.longitude,itime:o};n.callJAnalytics(r.packageInterfaceMessageBody(r.ACTION_ONLOC,t)),setTimeout(function(){n.onLocInfo()},9e5)},function(){a.Log.ww(l,"Get loc info failed.")})},e.prototype.onEvent=function(e){this.mIsInited&&105!==this.mRegisterCode&&1005!==this.mRegisterCode&&1008!==this.mRegisterCode&&1009!==this.mRegisterCode?u.checkEvent(e)&&(a.Log.dd(l,"onEvent type:"+e.type),e.itime=parseInt((new Date).getTime()/1e3+""),this.mIsRegister?this.reportEvents([e],!1):(a.Log.dd(l,"Events will be reported after successful registration"),u.EventCacheHelper.saveEvent(e),!1===this.mIsRegister&&(a.Log.dd(l,"Try to register again"),this.mIsRegister=void 0,this.register(this.mInitConfig)))):a.Log.ee(l,"Call onEvent failed:please call init correctly first")},e.prototype.reportEvents=function(e,t){a.Log.d(l,"reportEvents "+JSON.stringify(e)),u.isEventsEmpty(e)||(a.Log.dd(l,"Report events."),this.callJAnalytics(r.packageInterfaceMessageBody(r.ACTION_ONEVENT,u.buildEventsJSON(e)),function(e){e.action==r.ACTION_ONEVENT&&(u.EventCacheHelper.setUsingStatu(!1),1==e.code&&t&&u.EventCacheHelper.clearEvents())}))},e.prototype.callJAnalytics=function(e,t){if(this.mJanalyticsFrame){if(t){var n=this.generateCallbackId();this.callbackCache[n]=t,e.callbackId=n}var o={from:"JAnalytics",type:"onMessage",body:e};this.mJanalyticsFrame.contentWindow.postMessage(JSON.stringify(o),"https://web-stat.jpush.cn")}},e.prototype.generateCallbackId=function(){var e="_"+Math.random().toString(36).substr(2,9);return this.callbackCache[e]&&(e=this.generateCallbackId()),e},e}());window.JAnalyticsInterface={init:function(e){d.init(e)},Event:i,onEvent:function(e){d.onEvent(e)}}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var r=n(0),a=function(){function e(){this.type="",this.attributes={},this.excludes={}}return e.prototype.addKeyValue=function(e,t){return e?this.attributes[e]=t:r.Log.ww("event","invalide key:"+e),this},e.prototype.addExtMap=function(e){for(var t in void 0===e&&(e={}),e)this.addKeyValue(t,e[t]);return this},e}(),s=function(o){function e(e,t){var n=o.call(this)||this;return n.type="custom_counting",n.excludes={event_id:"10"},n.attributes.event_id=e,n.addExtMap(t),n}return i(e,o),e}(t.Event=a);t.CountEvent=s;var c=function(r){function e(e,t,n){var o=r.call(this)||this;return o.type="custom_calculate",o.excludes={event_id:"10",event_value:"111"},o.attributes.event_id=e,o.attributes.event_value=t,o.addExtMap(n),o}return i(e,r),e.prototype.setEventValue=function(e){this.attributes.event_value=e},e}(a);t.CalculateEvent=c;var u=function(r){function e(e,t,n){var o=r.call(this)||this;return o.type="custom_login",o.excludes={login_method:"10",login_success:"12"},o.attributes.login_method=e,o.attributes.login_success=t,o.addExtMap(n),o}return i(e,r),e}(a);t.LoginEvent=u;var l=function(r){function e(e,t,n){var o=r.call(this)||this;return o.type="custom_register",o.excludes={register_method:"10",register_success:"12"},o.attributes.register_method=e,o.attributes.register_success=t,o.addExtMap(n),o}return i(e,r),e}(a);t.RegisterEvent=l;var d=function(a){function e(e,t,n,o,r){var i=a.call(this)||this;return i.type="custom_browse",i.excludes={browse_content_id:"00",browse_name:"10",browse_type:"00",browse_duration:"010"},i.attributes.browse_content_id=e,i.attributes.browse_name=t,i.attributes.browse_type=n,i.attributes.browse_duration=o,i.addExtMap(r),i}return i(e,a),e}(a);t.BrowseEvent=d;var p=function(u){function e(e,t,n,o,r,i,a,s){var c=u.call(this)||this;return c.type="custom_purchase",c.excludes={purchase_goods_id:"00",purchase_goods_name:"00",purchase_price:"111",purchase_success:"12",purchase_currency:"00",purchase_goods_type:"00",purchase_quantity:"010"},c.attributes.purchase_goods_id=e,c.attributes.purchase_goods_name=t,c.attributes.purchase_price=n,c.attributes.purchase_success=o,c.attributes.purchase_currency=r,c.attributes.purchase_goods_type=i,c.attributes.purchase_quantity=a,c.addExtMap(s),c}return i(e,u),e}(a);t.PurchaseEvent=p},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var JGLog_1=__webpack_require__(0),TAG="EventHelper",EventCache=function(){function e(){this.events=[],this.isUsing=!1}return e.prototype.trySaveEvent=function(e){return this.isUsing?[e]:this.saveEvent(e)},e.prototype.saveEvent=function(e){return this.events.push(e),this.events},e.prototype.getEvents=function(){return this.setUsingStatu(!0),this.events},e.prototype.clearEvents=function(){this.setUsingStatu(!1),this.events=[]},e.prototype.setUsingStatu=function(e){this.isUsing=e},e}();exports.EventCacheHelper=new EventCache;var EXT_KEY_COUNT_LIMIT=10,KEY_VALUE_SIZE_LIMIT=256,TYPES=["string","number","boolean"];function isEventsEmpty(e){return void 0===e||0==e.length}function buildEventsJSON(e){var r=[];return e.forEach(function(e){var t={};for(var n in e.attributes)t[n]=e.attributes[n];var o={type:e.type,itime:0,attributes:t};o.itime=e.itime,JGLog_1.Log.d(TAG,"event buildJSON :"+JSON.stringify(o)),r.push(o)}),r}function checkEvent(e){if(!e)return logEmpty("event"),!1;var t=e.type,n=e.excludes,o=e.attributes;for(var r in n)if(1==n[r].match(/./g)[0]){var i=o[r];if(null==i)return logInvalid(r+" must be not null"),!1;if(i==1/0)return logInvalid("the "+r+" value exceed limits"),!1;if(validParams(0,i)&&(""==i||new RegExp("^[ ]+$").test(i)))return logInvalid(r+" must be not null"),!1}var a=0,s={};for(var r in o){var c=o[r];if(null==c);else{if(byteCount(r)>KEY_VALUE_SIZE_LIMIT||byteCount(c+"")>KEY_VALUE_SIZE_LIMIT)return logInvalid("key/value size must be less than 256 bytes"),!1;if(r in n){var u=n[r].match(/./g)[1];if(!validParams(u,c))return logInvalid("the "+r+" value type must be "+TYPES[u]),!1;if(1==u&&0==n[r].match(/./g)[2]){if(!validInteger(c))return logInvalid("the "+r+" value must be integer"),!1;if(!validIntegerRange(c))return logInvalid("the "+r+" value exceed limits"),!1}if("custom_purchase"==t&&"purchase_currency"==r&&"CNY"!=c&&"USD"!=c)return logInvalid("the "+r+" value must be CNY or USD"),!1}else a++;s[r]=c}}return EXT_KEY_COUNT_LIMIT<a?(JGLog_1.Log.ee(TAG,"This event will not record, since you have more than 10 pairs of custom key/value"),!1):(e.attributes=s,!0)}function logEmpty(e){JGLog_1.Log.ee(TAG,e+" cannot be empty")}function logInvalid(e){JGLog_1.Log.ee(TAG,"Parameter invalid,"+e)}function byteCount(e){return encodeURI(e).split(/%(?:u[0-9A-F]{2})?[0-9A-F]{2}|./).length-1}function validParams(e,t){return typeof t===TYPES[e]&&t==t}function validInteger(e){return e%1==0}function validIntegerRange(para){return!(eval(para+"")<=-0x8000000000000000||0x8000000000000000<=eval(para+""))}exports.isEventsEmpty=isEventsEmpty,exports.buildEventsJSON=buildEventsJSON,exports.checkEvent=checkEvent}]);